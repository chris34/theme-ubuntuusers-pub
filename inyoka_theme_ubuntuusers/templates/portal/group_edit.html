{#
    portal/group_edit.html
    ~~~~~~~~~~~~~~~~~


    Edit/Create a new group.

    :copyright: (c) 2007-2016 by the Inyoka Team, see AUTHORS for more details.
    :license: BSD, see LICENSE for more details.
#}
{%- extends 'portal/overall.html' %}
{% from 'macros.html' import render_form %}

{% set tmp_crumb = [(_('Groups'), href('portal', 'groups'))] %}
{% if is_new %}
  {% do tmp_crumb.append((_('New group'), href('portal', 'group', 'new'))) %}
{% else %}
  {% do tmp_crumb.extend([(_('Edit'), href('portal', 'group', group_name, 'edit')),
              (group.name, group|url)]) %}
{% endif %}
{% set BREADCRUMBS = tmp_crumb + BREADCRUMBS|d([]) %}

{% set scripts = ['PrivilegeBox'] %}

{% block content %}
<h3>{% trans %}Group configuration{% endtrans %}</h3>
<form enctype="multipart/form-data" action="" method="post">
	{{ csrf_token() }}
  <dl>
    {{ render_form(form, ['name'], inline=true) }}
    <dt>
      <label for="{{ form.is_public.auto_id }}">{{ form.is_public.label }}</label>
    </dt>
    <dd>
      {{ form.is_public }} <span class="help_text">{{ form.is_public.help_text }}</span>
      {{- form.is_public.errors }}
    </dd>
    <dl>
      <dt>{% trans %}Team icon:{% endtrans %}</dt>
      {% if group.icon %}<dd><img class="admin_teamicon" src="{{ group.icon_url }}" alt="Team-Icon" /></dd>{% endif %}
      <dd>{{ form.icon }}</dd>
      {% if group.icon -%}
      <dd>
        <input type="checkbox" name="icon-clear" id="icon-clear_id" />
        <label for="icon-clear_id">
          {%- trans %}Delete team icon{% endtrans -%}
        </label>
      </dd>
      {%- endif %}
      {%- if team_icon_height >= 0 and team_icon_width >= 0 %}
      <dd class="note">
        {%- trans width=team_icon_width, height=team_icon_height -%}
          Please note that the team icon can not be bigger than {{ width }}x{{ height }} pixel. Images exceeding this limit will be resized automatically.
        {%- endtrans -%}
      </dd>
      {%- endif %}
      {%- if form.errors.icon %}<dd>{{ form.errors.icon }}</dd>{% endif %}
      <dd>{{ form.import_icon_from_global }} <label for="id_import_icon_from_global">Globales Team-Icon importieren</label></dd>
      {%- if form.errors.import_icon_from_global %}<dd>{{ form.errors.import_icon_from_global }}</dd>{% endif %}
    </dl>
    {{ render_form(form, ['permissions']) }}
    <dt>{% trans %}Forum privileges:{% endtrans %}</dt>
    <dd id="forum_rights">{% trans %}Please turn JavaScript on to edit the privileges.{% endtrans %}</dd>
  </dl>
  <input type="submit" value="{% trans %}Submit{% endtrans %}" />
</form>
{% endblock %}

{% block additional_scripts %}
  {{ super() }}
  <script type="text/javascript">
    /* <![CDATA[ */
    var forum_rights = new PrivilegeBox('#forum_rights', {{ group_forum_privileges|jsonencode }},
      {{ forum_privileges|jsonencode }});
    $('input.permission').parent().parent().parent().attr('class', 'permissions');
    /* ]]> */
  </script>
{% endblock %}
